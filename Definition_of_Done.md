# Definition of Done

| #  | Concrete task                                                                                                      | Why first?                                                                                          | What “done” looks like                                                                                         | Typical pitfalls to avoid                                                         |
|----|--------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------|
| 0  | Lock the project scope in one page — write a “Definition of Done” that lists one doctor flow and one patient flow. | Stops scope‑creep and keeps every later decision anchored to a user story.                          | A single Markdown file in the repo, agreed with your advisor.                                                   | Adding “maybe we could also…” features later; resist!                              |
| 1  | Create the mono‑repo + CI pipeline (GitHub + Actions pre‑configuring lint/format/test).                             | Fast feedback loop; failing tests break early.                                                      | main branch runs black / ruff / pytest and Docker build on push.                                                | Skipping CI until the end → integration hell.                                      |
| 2  | Design the clinical data schema (ERD) on Postgres first, before you touch any AI code.                              | Everything else (MCP, vectors, graph) plugs into this.                                               | ERD includes tables: patients, visits, notes, labs, foreign keys + row‑level security policy sketches.         | a) Over‑normalising (too many tiny tables). b) Forgetting indexes on patient_id.   |
| 3  | Spin up Postgres + pgvector + (AGE or Neo4j) in Docker Compose. Load 5–10 dummy patients.                           | Gives a safe playground to iterate quickly.                                                          | docker compose up starts DBs, make load_dummy_data inserts seed rows.                                          | Installing extensions manually every time; automate in init.sql.                  |
| 4  | Implement row‑level security & roles (doctor, patient, admin) and test with psql.                                   | Security baked‑in beats retrofitting later.                                                          | SELECT * FROM notes as patient returns only their MRN rows.                                                     | a) Forgetting ALTER TABLE … ENABLE RLS. b) Hard‑coding superuser creds in code.    |
| 5  | Put the MCP side‑car in front of Postgres and confirm read and write with curl or Python client.                    | Verifies the protocol layer before LangChain touches it.                                            | A script inserts a note via MCP, then reads it back.                                                             | Mis‑mapping MCP tokens to Postgres roles → RLS silently bypassed.                   |
| 6  | Baseline vector RAG POC (no graph yet):— embed notes,— similarity search,— LLM call that cites the retrieved chunk. | Establishes an end‑to‑end “hello‑world” you can always fall back to.                                 | Running python rag_query.py "What meds is John on?" prints correct answer.                                     | a) Huge chunk size → irrelevant matches. b) Forgetting to strip PHI from text.     |
| 7  | Entity‑extraction notebook — run spaCy/LLM on a batch of notes and export CSV of nodes/edges.                       | Lets you calibrate extraction quality before writing the ingestion worker.                           | Jupyter notebook shows precision/recall > 0.8 on a hand‑labelled sample.                                         | Diving into building the full pipeline before measuring extraction accuracy.       |
| 8  | Graph store ingestion script — take the CSV from 7, insert into Neo4j/AGE, query a sample path.                    | Confirms your schema & Cypher patterns.                                                              | MATCH p=(n:Patient)-[*2]->(l:Lab) RETURN p LIMIT 1 shows expected nodes.                                        | a) Duplicated nodes (no MERGE). b) Not indexing patient_id in graph.              |
| 9  | LangGraph multi‑retriever wrapper – route to vector or graph based on keywords; hard‑code simple heuristics first.   | Proves orchestration logic independent of fancy LLM routing.                                         | Unit test passes: “why” query hits graph; “what is” hits vector.                                                  | Building an LLM intent classifier before heuristics → lost time.                  |
| 10 | Minimal Next.js chat UI wired to FastAPI endpoint; no auth yet.                                                    | Lets you demo progress each week to stakeholders.                                                    | Typing a question in browser returns JSON answer.                                                                 | Spending days perfecting UI styling; placeholder CSS is fine for now.              |
| 11 | OAuth & JWT mapping → Postgres roles; connect to chat UI.                                                           | Security milestone before adding more agents.                                                        | Logging in as patient limits answers; token introspection tested.                                               | Trying to write your own auth server; just use NextAuth or Auth0 free tier.       |
| 12 | Guard‑rail agent & evaluation harness (ragas, unit tests for role leaks).                                            | Catches PHI or hallucinations early.                                                                | CI job fails if answer accuracy < 60% or leak detected.                                                          | Ignoring evaluation until final week.                                             |
| 13 | Iterate UI + PDF generator, polish docs, record demo.                                                              | Final fit & finish once core is solid.                                                              | Reviewer can reproduce with docker compose up.                                                                    | Leaving docs/demo till night before submission.                                   |
